<!DOCTYPE html>
<html>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <head>
    <title>
      Demo website
    </title>
    <script>
      // load Branch
      (function(b,r,a,n,c,h,_,s,d,k){if(!b[n]||!b[n]._q){for(;s<_.length;)c(h,_[s++]);d=r.createElement(a);d.async=1;d.src="https://cdn.branch.io/branch-latest.min.js";k=r.getElementsByTagName(a)[0];k.parentNode.insertBefore(d,k);b[n]=h}})(window,document,"script","branch",function(b,r){b[r]=function(){b._q.push([r,arguments])}},{_q:[],_v:1},"addListener applyCode autoAppIndex banner closeBanner closeJourney creditHistory credits data deepview deepviewCta first getCode init link logout redeem referrals removeListener sendSMS setBranchViewData setIdentity track validateCode trackCommerceEvent logEvent disableTracking".split(" "), 0);
      // init Branch
      branch.init('key_live_nmKsJoHPg5wa3iPuN5lqPjlgrva1uBNq',
      {
        'no_journeys': true
      });
      function triggerJourneys()
      {
        branch.track('pageview',
        {
           'meta' : 'tags'
        });
      }
      function create_deeplink(username)
      {
        var linkData = {
        campaign: 'create deeplink',
        channel: 'website',
        feature: 'deeplink_test',
        stage: 'new user',
        alias: 'login-link',
        data: 
          {
            'user_name': username,
            'date_now': Date.now(),
            '$og_title': 'App Download Link',
            '$og_description': 'This is my app download test',
            '$og_image_url':'http://lorempixel.com/400/400'
          }
        };
        branch.link(linkData, function(err, link) 
        {
          console.log(link);
          return link;
        });
      }
      
      function trigger_purchase(){
        var event_and_custom_data = {
          "transaction_id": "tras_Id_1232343434",
          "currency": "USD",
          "revenue": 180.2,
          "shipping": 10.5,
          "tax": 13.5,
          "coupon": "promo-1234",
          "affiliation": "high_fi",
          "description": "Preferred purchase"
        };

      var content_items = [
      {
        "$content_schema": "COMMERCE_PRODUCT",
        "$og_title": "Nike Shoe",
        "$og_description": "Start loving your steps",
        "$og_image_url": "http://example.com/img1.jpg",
        "$canonical_identifier": "nike/1234",
        "$publicly_indexable": false,
        "$price": 101.2,
        "$locally_indexable": true,
        "$quantity": 1,
        "$sku": "1101123445",
        "$product_name": "Runner",
        "$product_brand": "Nike",
        "$product_category": "Sporting Goods",
        "$product_variant": "XL",
        "$rating_average": 4.2,
        "$rating_count": 5,
        "$rating_max": 2.2,
        "$creation_timestamp": 1499892854966,
        "$exp_date": 1499892854966,
        "$keywords": [ "sneakers", "shoes" ],
        "$address_street": "230 South LaSalle Street",
        "$address_city": "Chicago",
        "$address_region": "IL",
        "$address_country": "US",
        "$address_postal_code": "60604",
        "$latitude": 12.07,
        "$longitude": -97.5,
        "$image_captions": [ "my_img_caption1", "my_img_caption_2" ],
        "$condition": "NEW",
        "$custom_fields": {"foo1":"bar1","foo2":"bar2"}
      },
      {
         "$og_title": "Nike Woolen Sox",
         "$canonical_identifier": "nike/5324",
         "$og_description": "Fine combed woolen sox for those who love your foot",
         "$publicly_indexable": false,
         "$price": 80.2,
         "$locally_indexable": true,
         "$quantity": 5,
         "$sku": "110112467",
         "$product_name": "Woolen Sox",
         "$product_brand": "Nike",
         "$product_category": "Apparel & Accessories",
         "$product_variant": "Xl",
         "$rating_average": 3.3,
         "$rating_count": 5,
         "$rating_max": 2.8,
         "$creation_timestamp": 1499892854966
      }];

      var customer_event_alias = "my custom alias";

      branch.logEvent(
        "PURCHASE",
        event_and_custom_data,
        content_items,
        customer_event_alias,
      function(err) { console.log(err); }
      );
   }
      
   function empty_event(){
      var event_and_custom_data = {
                    "abc": null,
                };
                branch.logEvent(
                    "event name",
                    event_and_custom_data,
                    function(err) { console.log(err); }
                );
   }
    
    </script>
    <style>
      .button {
        background-color: #08B9E4;
        padding: 15px 32px;
        text-align: center;
        text-decoration: none;
        display: inline-block;
        font-size: 16px;
        margin: 4px 2px;
        cursor: pointer;
      }
    </style>
    </head>
    <body>
      <p>Hey Man! <br/></p>
      <button id="demo" class="button" onclick="triggerJourneys()" >Click Here</button>
      <button id="demo" class="button" onclick="create_deeplink('deepen')" >Click Here</button>
      <button onclick="trigger_purchase()">Track Purchase</button>
      <button onclick="empty_event()">Track Purchase</button>
      <a href = "https://impression.link/impression?branch_key=key_live_nmKsJoHPg5wa3iPuN5lqPjlgrva1uBNq&%243p=a_custom_697893896122634678&~branch_ad_format=App%20Only&~feature=paid%20advertising"> Testing impressions </a>
 
  </body>
</html>

